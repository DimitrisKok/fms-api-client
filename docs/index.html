<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Client.html">Client</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.authenticate">authenticate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.edit">edit</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.fieldData">fieldData</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.find">find</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.globals">globals</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.list">list</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.logout">logout</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.recordId">recordId</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.saveState">saveState</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.script">script</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#.upload">upload</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#_createURL">_createURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#_deleteURL">_deleteURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#_findURL">_findURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#_getURL">_getURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#_globalsURL">_globalsURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#_listURL">_listURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#_updateURL">_updateURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#_uploadURL">_uploadURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#preInit">preInit</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Connection.html">Connection</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Connection.html#._authURL">_authURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Connection.html#._basicAuth">_basicAuth</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Connection.html#._logoutURL">_logoutURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Connection.html#._saveToken">_saveToken</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Connection.html#.extend">extend</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Connection.html#.generate">generate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Connection.html#.remove">remove</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Connection.html#.valid">valid</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Credentials.html">Credentials</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-Data-Data.html">Data</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Client.html">Client</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Connection.html">Connection</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Credentials.html">Credentials</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Data.html">Data</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-Utilities.html">Utilities</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Utilities.html#~filterResponse">filterResponse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Utilities.html#~isJson">isJson</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Utilities.html#~map">map</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Utilities.html#~namespace">namespace</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Utilities.html#~sanitizeParameters">sanitizeParameters</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Utilities.html#~stringify">stringify</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-Utilities.html#~toArray">toArray</a></span></li>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1>fms-api-client <a href="https://travis-ci.org/Luidog/fms-api-client"><img src="https://travis-ci.org/Luidog/fms-api-client.png?branch=master" alt="Build Status"></a> <a href="https://snyk.io/test/github/Luidog/fms-api-client?targetFile=package.json"><img src="https://snyk.io/test/github/Luidog/fms-api-client/badge.svg?targetFile=package.json" alt="Known Vulnerabilities"></a> <a href="https://coveralls.io/github/Luidog/fms-api-client?branch=master"><img src="https://coveralls.io/repos/github/Luidog/fms-api-client/badge.svg?branch=master" alt="Coverage Status"></a> <a href="https://github.com/Luidog/fms-api-client/issues"><img src="https://img.shields.io/github/issues/Luidog/fms-api-client.svg?style=plastic" alt="GitHub issues"></a> <a href="https://img.shields.io/github/issues/Luidog/fms-api-client.svg"><img src="https://img.shields.io/github/commits-since/luidog/fms-api-client/latest.svg" alt="Github commits (since latest release)"></a>  <a href="https://github.com/Luidog/fms-api-client/blob/master/LICENSE.md"><img src="https://img.shields.io/github/license/Luidog/fms-api-client.svg" alt="GitHub license"></a></h1><p>A FileMaker Data API client designed to allow easier interaction with a FileMaker application from a web environment.</p>
<h2>Installation</h2><p>This is a <a href="https://nodejs.org/">Node.js</a> module available through the 
<a href="https://www.npmjs.com/">npm registry</a>. It can be installed using the 
<a href="https://docs.npmjs.com/getting-started/installing-npm-packages-locally"><code>npm</code></a>
or 
<a href="https://yarnpkg.com/en/"><code>yarn</code></a>
command line tools.</p>
<pre class="prettyprint source lang-sh"><code>npm install fms-api-client --save</code></pre><h2>Usage</h2><pre class="prettyprint source lang-js"><code>'use strict';

/* eslint-disable */

const colors = require('colors');

/* eslint-enable */

const environment = require('dotenv');
const varium = require('varium');
const { connect } = require('marpat');
const { Filemaker } = require('fms-api-client');

environment.config({ path: './tests/.env' });

varium(process.env, './tests/env.manifest');

/**
 * Connect must be called before the filemaker class is instiantiated. This
 * connect uses Marpat. Marpat is a fork of Camo. much love to
 * https://github.com/scottwrobinson for his creation and maintenance of Camo.
 * My fork of Camo - Marpat is designed to allow the use of multiple datastores
 * with the focus on encrypted storage.
 */

connect('nedb://memory').then(db => {
  /**
   * The client is the FileMaker class. The class then offers methods designed to
   * make it easier to integrate into filemaker's api.
   */

  const client = Filemaker.create({
    application: process.env.APPLICATION,
    server: process.env.SERVER,
    user: process.env.USERNAME,
    password: process.env.PASSWORD
  });

  /**
   * A client can be used directly after saving it. It is also stored on the
   * datastore so that it can be reused later.
   */
  client.save().then(client =>
    /**
     * Using the client you can create filemaker records. To create a record
     * specify the layout to use and the data to insert on creation. The client
     * will automatically convert numbers, arrays, and objects into strings so
     * they can be inserted into a filemaker field.
     */
    client
      .create(
        'Heroes',
        {
          name: 'George Lucas',
          number: 5,
          array: ['1'],
          object: { driods: true }
        },
        { merge: true }
      )
      .then(record =>
        console.log('Some guy thought of a movie....'.yellow.underline, record)
      )
      .catch(error => console.log('That is no moon....'.red, error))
  );

  /**
   * Most methods on the client are promises. The only exceptions to this are
   * the utility methods of fieldData(), and recordId(). You can chain together
   * multiple methods such as record creation.
   */
  client
    .save()
    .then(client => {
      return Promise.all([
        client.create('Heroes', { name: 'Anakin Skywalker' }),
        client.create('Heroes', { name: 'Obi-Wan' }),
        client.create('Heroes', { name: 'Yoda' })
      ]).then(response => {
        console.log('A Long Time Ago....'.rainbow.underline, response);
        return client;
      });
    })
    .then(client => {
      /**
       * You can use the client to list filemaker records. The List method
       * accepts a layout and parameter variable. The client will automatically
       * santize the limit, offset, and sort keys to correspond with the Data
       * API's requirements.
       */
      client
        .list('Heroes', { limit: 5 })
        .then(response => client.fieldData(response.data))
        .then(response =>
          console.log(
            ' For my ally is the Force, and a powerful ally it is.'.underline
              .green,
            response
          )
        )
        .catch(error => console.log('That is no moon....'.red, error));
      /**
       * You can also use the client to set FileMaker Globals for the session.
       */
      client
        .globals({ 'Globals::ship': 'Millenium Falcon' })
        .then(response =>
          console.log(
            'Made the Kessel Run in less than twelve parsecs.'.underline.blue,
            response
          )
        )
        .catch(error => console.log('That is no moon....'.red, error));

      return client;
    })
    .then(client => {
      /**
       * The client's find method  will accept either a single object as find
       * parameters or an array. The find method will also santize the limit,
       * sort, and offset parameters to conform with the Data API's
       * requirements.
       */
      client
        .find('Heroes', [{ name: 'Anakin Skywalker' }], { limit: 1 })
        .then(response => client.recordId(response.data))
        .then(recordIds =>
          client.edit('Heroes', recordIds[0], { name: 'Darth Vader' })
        )
        .then(response =>
          console.log(
            'I find your lack of faith disturbing'.cyan.underline,
            response
          )
        )
        .catch(error => console.log('That is no moon...'.red, error));

      client
        .upload('./assets/placeholder.md', 'Heroes', 'image')
        .then(response => {
          console.log('Perhaps an Image...'.cyan.underline, response);
        })
        .catch(error => console.log('That is no moon...'.red, error));

      client
        .find('Heroes', [{ name: 'Luke Skywalker' }], { limit: 1 })
        .then(response => client.recordId(response.data))
        .then(recordIds =>
          client.upload(
            './assets/placeholder.md',
            'Heroes',
            'image',
            recordIds[0]
          )
        )
        .then(response => {
          console.log('Dont Forget Luke...'.cyan.underline, response);
        })
        .catch(error => console.log('That is no moon...'.red, error));

      client
        .script('FMS Triggered Script', 'Heroes')
        .then(response => {
          console.log('or a script....'.cyan.underline, response);
        })
        .catch(error => console.log('That is no moon...'.red, error));
    })
    .catch(error => console.log('That is no moon...'.red, error));

  client
    .find('Heroes', [{ name: 'Darth Vader' }], {
      limit: 1,
      script: 'example script',
      'script.param': 'han'
    })
    .then(response =>
      console.log(
        'I find your lack of faith disturbing'.cyan.underline,
        response
      )
    )
    .catch(error => console.log('find - That is no moon...'.red, error));
});

const rewind = () => {
  Filemaker.findOne().then(client => {
    console.log(client.data.status());
    client
      .find('Heroes', [{ id: '*' }], { limit: 10 })
      .then(response => client.recordId(response.data))
      .then(response => {
        console.log('Be Kind.... Rewind.....'.rainbow, response);
        return response;
      })
      .then(recordIds =>
        recordIds.forEach(id => {
          client
            .delete('Heroes', id)
            .catch(error => console.log('That is no moon....'.red, error));
        })
      );
  });
};

setTimeout(() => rewind(), 10000);
</code></pre><h2>Tests</h2><pre class="prettyprint source lang-sh"><code>npm install
npm test</code></pre><pre class="prettyprint source"><code>
> fms-api-client@1.2.0 test /fms-api-client
> nyc _mocha --recursive ./tests --timeout=30000 --exit
  Authentication Capabilities
    ✓ should authenticate into FileMaker. (606ms)
    ✓ should automatically request an authentication token (162ms)
    ✓ should reuse a saved authentication token (161ms)
    ✓ should log out of the filemaker. (164ms)
    ✓ should not attempt a logout if there is no valid token.
    ✓ should reject if the logout request fails (169ms)
    ✓ should reject if the authentication request fails (1416ms)
  Create Capabilities
    ✓ should create FileMaker records. (161ms)
    ✓ should reject bad data with an error (175ms)
    ✓ should create FileMaker records with mixed types (203ms)
    ✓ should substitute an empty object if data is not provided (156ms)
    ✓ should return an object with merged filemaker and data properties (156ms)
    ✓ should allow you to run a script when creating a record with a merge response (174ms)
    ✓ should sanitize parameters when creating a new record (165ms)
  Delete Capabilities
    ✓ should delete FileMaker records. (232ms)
    ✓ should reject deletions that do not specify a recordId (167ms)
  Edit Capabilities
    ✓ should edit FileMaker records.
    ✓ should reject bad data with an error (247ms)
  Find Capabilities
    ✓ should perform a find request (205ms)
    ✓ should allow you to use an object instead of an array for a find (158ms)
    ✓ should specify omit Criterea (209ms)
    ✓ should allow additional parameters to manipulate the results (188ms)
    ✓ should allow you to use numbers in the find query parameters (160ms)
    ✓ should allow you to sort the results (164ms)
    ✓ should return an empty array if the find does not return results (153ms)
    ✓ should allow you run a pre request script (167ms)
    ✓ should return a response even if a script fails (171ms)
    ✓ should allow you to send a parameter to the pre request script (173ms)
    ✓ should allow you run script after the find and before the sort (177ms)
    ✓ should allow you to pass a parameter to a script after the find and before the sort (218ms)
    ✓ should reject of there is an issue with the find request (203ms)
  Get Capabilities
    ✓ should get specific FileMaker records. (247ms)
    ✓ should reject get requests that do not specify a recordId (236ms)
  Global Capabilities
    ✓ should allow you to set FileMaker globals (246ms)
    ✓ should reject with a message and code if it fails to set a global (196ms)
  List Capabilities
    ✓ should allow you to list records (195ms)
    ✓ should allow you use parameters to modify the list response (164ms)
    ✓ should should allow you to use numbers in parameters (159ms)
    ✓ should modify requests to comply with DAPI name reservations (161ms)
    ✓ should allow strings while complying with DAPI name reservations (163ms)
    ✓ should allow you to offset the list response (162ms)
    ✓ should reject requests that use unexpected parameters (167ms)
  Script Capabilities
    ✓ should allow you to trigger a script in FileMaker (189ms)
    ✓ should allow you to trigger a script in FileMaker (216ms)
    ✓ should allow you to trigger a script in a find (198ms)
    ✓ should allow you to trigger a script in a list (172ms)
    ✓ should allow reject a script that does not exist (156ms)
    ✓ should allow return a result even if a script returns an error (181ms)
    ✓ should parse script results if the results are json (174ms)
    ✓ should not parse script results if the results are not json (211ms)
  Storage
    ✓ should allow an instance to be created
    ✓ should allow an instance to be saved.
    ✓ should allow an instance to be recalled
    ✓ should allow insances to be listed
    ✓ should allow you to remove an instance
  File Upload Capabilities
    ✓ should allow you to upload a file to a new record (1542ms)
    ✓ should allow you to upload a file to a specific container repetition (1525ms)
    ✓ should reject with a message if it can not find the file to upload (163ms)
    ✓ should allow you to upload a file to a specific record (1427ms)
    ✓ should allow you to upload a file to a specific record container repetition (1408ms)
    ✓ should reject of the request is invalid (320ms)
  Data Usage Tracking Capabilities
    ✓ should track API usage data. (210ms)
    ✓ should allow you to reset usage data. (152ms)
  Utility Capabilities
    ✓ should extract field while maintaining the array (241ms)
    ✓ should extract field data while maintaining the object (223ms)
    ✓ should extract the recordId while maintaining the array (233ms)
    ✓ should extract field data while maintaining the object (287ms)
  67 passing (18s)
-----------------------|----------|----------|----------|----------|-------------------|
File                   |  % Stmts | % Branch |  % Funcs |  % Lines | Uncovered Line #s |
-----------------------|----------|----------|----------|----------|-------------------|
All files              |      100 |      100 |      100 |      100 |                   |
 fms-api-client        |      100 |      100 |      100 |      100 |                   |
  index.js             |      100 |      100 |      100 |      100 |                   |
 fms-api-client/src    |      100 |      100 |      100 |      100 |                   |
  client.model.js      |      100 |      100 |      100 |      100 |                   |
  connection.model.js  |      100 |      100 |      100 |      100 |                   |
  credentials.model.js |      100 |      100 |      100 |      100 |                   |
  data.model.js        |      100 |      100 |      100 |      100 |                   |
  index.js             |      100 |      100 |      100 |      100 |                   |
  utilities.service.js |      100 |      100 |      100 |      100 |                   |
-----------------------|----------|----------|----------|----------|-------------------|
</code></pre><h2>Dependencies</h2><ul>
<li><a href="https://ghub.io/axios">axios</a>: Promise based HTTP client for the browser and node.js</li>
<li><a href="https://ghub.io/form-data">form-data</a>: A library to create readable &quot;multipart/form-data&quot; streams. Can be used to submit forms and file uploads to other web applications.</li>
<li><a href="https://ghub.io/lodash">lodash</a>: Lodash modular utilities.</li>
<li><a href="https://ghub.io/marpat">marpat</a>: A class-based ES6 ODM for Mongo-like databases.</li>
<li><a href="https://ghub.io/moment">moment</a>: Parse, validate, manipulate, and display dates</li>
<li><a href="https://ghub.io/object-sizeof">object-sizeof</a>: Sizeof of a JavaScript object in Bytes</li>
<li><a href="https://ghub.io/prettysize">prettysize</a>: Convert bytes to other sizes for prettier logging</li>
</ul>
<h2>Dev Dependencies</h2><ul>
<li><a href="https://ghub.io/chai">chai</a>: BDD/TDD assertion library for node.js and the browser. Test framework agnostic.</li>
<li><a href="https://ghub.io/chai-as-promised">chai-as-promised</a>: Extends Chai with assertions about promises.</li>
<li><a href="https://ghub.io/colors">colors</a>: get colors in your node.js console</li>
<li><a href="https://ghub.io/coveralls">coveralls</a>: takes json-cov output into stdin and POSTs to coveralls.io</li>
<li><a href="https://ghub.io/dotenv">dotenv</a>: Loads environment variables from .env file</li>
<li><a href="https://ghub.io/eslint">eslint</a>: An AST-based pattern checker for JavaScript.</li>
<li><a href="https://ghub.io/eslint-config-google">eslint-config-google</a>: ESLint shareable config for the Google style</li>
<li><a href="https://ghub.io/eslint-config-prettier">eslint-config-prettier</a>: Turns off all rules that are unnecessary or might conflict with Prettier.</li>
<li><a href="https://ghub.io/eslint-plugin-prettier">eslint-plugin-prettier</a>: Runs prettier as an eslint rule</li>
<li><a href="https://ghub.io/jsdocs">jsdocs</a>: jsdocs</li>
<li><a href="https://ghub.io/minami">minami</a>: Clean and minimal JSDoc 3 Template / Theme</li>
<li><a href="https://ghub.io/mocha">mocha</a>: simple, flexible, fun test framework</li>
<li><a href="https://ghub.io/mocha-lcov-reporter">mocha-lcov-reporter</a>: LCOV reporter for Mocha</li>
<li><a href="https://ghub.io/nyc">nyc</a>: the Istanbul command line interface</li>
<li><a href="https://ghub.io/package-json-to-readme">package-json-to-readme</a>: Generate a README.md from package.json contents</li>
<li><a href="https://ghub.io/prettier">prettier</a>: Prettier is an opinionated code formatter</li>
<li><a href="https://ghub.io/varium">varium</a>: A strict parser and validator of environment config variables</li>
</ul>
<h2>License</h2><p>MIT</p></article>
    </section>






</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Jun 19 2018 21:27:37 GMT-0700 (PDT) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>